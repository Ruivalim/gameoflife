"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var ConwaysGameOfLife=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:800,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:800,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];_classCallCheck(this,t),"object"==_typeof(e)?(this.canvas=e.canvas,e.speed?this.speed=e.speed:this.speed=n,e.width?this.width=e.width:this.width=i,e.height?this.height=e.height:this.height=r,e.resolution?this.resolution=e.resolution:this.resolution=s,e.saveHistory?this.saveHistory=e.saveHistory:this.saveHistory=o):(this.canvas=e,this.width=i,this.height=r,this.resolution=s,this.speed=1e3*n,this.saveHistory=o),this.cols=this.width/this.resolution,this.rows=this.height/this.resolution,this.ctx=this.canvas.getContext("2d"),this.gens=[],this.loop,this.lastGen,this.currentGen=0,this.initialState,this.paused=!1,this.started=!1,this.onRender,this.onNewGen,this.onGenUpdate,this.history=[],this.canvas.height=this.height,this.canvas.width=this.width,this.init()}return _createClass(t,[{key:"init",value:function(){var t=this.createInitialGen();this.initialState=t,this.render(t)}},{key:"start",value:function(){var t=this;if(!this.started){this.started=!0;var e=this.initialState;this.loop=window.setInterval((function(){e=t.newGen(e),t.render(e)}),this.speed)}}},{key:"pause",value:function(){this.paused||(clearInterval(this.loop),this.paused=!0)}},{key:"continue",value:function(){var t=this;if(this.paused){this.paused=!1;var e=this.lastGen;this.loop=window.setInterval((function(){e=t.newGen(e),t.render(e)}),this.speed)}}},{key:"reset",value:function(){this.pause(),this.history=[],this.gens=[],this.currentGen=0,this.loop=null,this.paused=!1,this.started=!1,this.init()}},{key:"setSpeed",value:function(t){this.speed=1e3*t}},{key:"getGen",value:function(){return this.currentGen}},{key:"getGenFromHistory",value:function(t){if(this.saveHistory)return this.history[t]}},{key:"gensNumbs",value:function(){return this.gens.length}},{key:"loadGen",value:function(t){var e=this.gens[t];this.render(e),this.currentGen=t}},{key:"addEvent",value:function(t,e){"onRender"==t&&(this.onRender=e),"onNewGen"==t&&(this.onNewGen=e)}},{key:"createInitialGen",value:function(){var t=this;return new Array(this.cols).fill(null).map((function(){return new Array(t.rows).fill(null).map((function(){return Math.floor(2*Math.random())}))}))}},{key:"newGen",value:function(t){var e=t.map((function(t){return _toConsumableArray(t)}));this.gens.push(e);for(var n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++){for(var r=t[n][i],s=0,o=-1;o<2;o++)for(var a=-1;a<2;a++)if(0!==o||0!==a){var h=n+o,u=i+a;if(h>=0&&u>=0&&h<this.cols&&u<this.rows)s+=t[h][u]}1===r&&s<2||1===r&&s>3?e[n][i]=0:0===r&&3===s&&(e[n][i]=1)}return this.saveHistory&&this.history.push(e),"function"==typeof this.onNewGen&&this.onNewGen(e),e}},{key:"displayGen",value:function(t){for(var e=0;e<t.length;e++)for(var n=0;n<t[e].length;n++){var i=t[e][n];this.ctx.beginPath(),this.ctx.rect(e*this.resolution,n*this.resolution,this.resolution,this.resolution),this.ctx.fillStyle=i?"black":"white",this.ctx.fill(),this.ctx.stroke()}}},{key:"render",value:function(t){this.currentGen=this.gens.length,this.lastGen=t.map((function(t){return _toConsumableArray(t)})),this.gen=this.gens.length+1,this.displayGen(t),"function"==typeof this.onRender&&this.onRender(this.currentGen)}}]),t}();